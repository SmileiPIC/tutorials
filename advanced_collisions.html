
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
    <meta charset="utf-8" />
    <title>Binary collisions and impact ionization &#8212; Smilei tutorials  unknown documentation</title>
    <link rel="stylesheet" href="_static/smilei_theme.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/language_data.js"></script>
    <script async="async" src="https://unpkg.com/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="shortcut icon" href="_static/smileiIcon.png"/>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Synchrotron-like radiation reaction" href="advanced_radiation_reaction.html" />
    <link rel="prev" title="Field ionization" href="advanced_field_ionization.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    "HTML-CSS": {
      scale: 95,
      availableFonts: ["TeX"]
    }
  });
  </script>
   
  </head><body>

<div id="smallScreenMenu" class="off">

    
    <div class="toctree-smilei">
        <ul>
                <li class="outer">
                    <a href="basics_setup.html">Setup</a>
                </li>
                <li class="outer">
                    <a href="basics_laser_vacuum.html">Laser Propagation in vacuum</a>
                </li>
                <li class="outer">
                    <a href="basics_thermal_plasma.html">Thermal plasma</a>
                </li>
                <li class="outer">
                    <a href="basics_weibel_twostream.html">Weibel and two-stream instabilities</a>
                </li>
                <li class="outer">
                    <a href="basics_units.html">Units</a>
                </li>
        </ul>
        <hr />
        <ul>
                <li class="outer">
                    <a href="perfs_parallel_computing.html">Parallel computing</a>
                </li>
                <li class="outer">
                    <a href="perfs_patch_arrangement.html">Patch arrangement</a>
                </li>
        </ul>
        <hr />
        <ul>
                <li class="outer">
                    <a href="advanced_field_ionization.html">Field ionization</a>
                </li>
        </ul>
                <ul>
<li><a class="reference internal" href="#">Binary collisions and impact ionization</a><ul>
<li><a class="reference internal" href="#beam-relaxation">Beam relaxation</a></li>
<li><a class="reference internal" href="#thermalization">Thermalization</a></li>
<li><a class="reference internal" href="#temperature-isotropization">Temperature isotropization</a></li>
<li><a class="reference internal" href="#maxwellianization">Maxwellianization</a></li>
<li><a class="reference internal" href="#stopping-power">Stopping power</a></li>
<li><a class="reference internal" href="#ionization-rate">Ionization rate</a></li>
<li><a class="reference internal" href="#inelastic-stopping-power">Inelastic stopping power</a></li>
<li><a class="reference internal" href="#multiple-ionization">Multiple ionization</a></li>
<li><a class="reference internal" href="#effect-of-neglecting-recombination">Effect of neglecting recombination</a></li>
</ul>
</li>
</ul>

        <ul id="smallScreenMenuAfterTOC">
                <li class="outer">
                    <a href="advanced_radiation_reaction.html">Synchrotron-like radiation reaction</a>
                </li>
                <li class="outer">
                    <a href="advanced_breit_wheeler.html">Multiphoton Breit-Wheeler pair creation process</a>
                </li>
                <li class="outer">
                    <a href="advanced_wakefield.html">2D laser wakefield acceleration</a>
                </li>
                <li class="outer">
                    <a href="advanced_wakefield_AMcylindrical.html">Azimuthal-mode-decomposition cylindrical geometry</a>
                </li>
                <li class="outer">
                    <a href="advanced_wakefield_electron_beam.html">Field initialization for a relativistic electron bunch</a>
                </li>
                <li class="outer">
                    <a href="advanced_wakefield_envelope.html">Envelope model for laser wakefield acceleration</a>
                </li>
                <li class="outer">
                    <a href="advanced_vtk.html">Export to VTK and 3D visualization</a>
                </li>
        </ul>
        <hr />
    </div>

</div>
<div id="hcontainer">
    <div id="nav_positioner">
        <div id="nav">
            <div id="nav_button" onclick="toggleNav()">
                Sections
            </div>
            <div id="nav_list" class="toctree-smilei">
                <div id="nav_title"><a href="#">Binary collisions and impact ionization</a></div>
                <ul>
<li><a class="reference internal" href="#">Binary collisions and impact ionization</a><ul>
<li><a class="reference internal" href="#beam-relaxation">Beam relaxation</a></li>
<li><a class="reference internal" href="#thermalization">Thermalization</a></li>
<li><a class="reference internal" href="#temperature-isotropization">Temperature isotropization</a></li>
<li><a class="reference internal" href="#maxwellianization">Maxwellianization</a></li>
<li><a class="reference internal" href="#stopping-power">Stopping power</a></li>
<li><a class="reference internal" href="#ionization-rate">Ionization rate</a></li>
<li><a class="reference internal" href="#inelastic-stopping-power">Inelastic stopping power</a></li>
<li><a class="reference internal" href="#multiple-ionization">Multiple ionization</a></li>
<li><a class="reference internal" href="#effect-of-neglecting-recombination">Effect of neglecting recombination</a></li>
</ul>
</li>
</ul>

            </div>
        </div>
    </div>
    
    <div class="headercolor">
    </div>
    <div class="hpositioner">
        <div class="header">
        <div class="logo">
            <a href="index.html">
                <img class="logo" src="_static/smileiLogo_tutorials.svg" alt="Logo" />
            </a>
        </div>
        <div class="menu"
            id="menu_PIC basics"
            
        >
            <div id="menuButton_PIC basics" class="menuButton"
                 onmouseenter="prepareMenu('menu_PIC basics')"
                 onmousedown="event.preventDefault()"
            >
                <a href="basics.html">
                    <span>PIC basics</span>
                </a>
            </div>
            <div class="off" onmouseleave="leaveMenu('menu_PIC basics',this)">
                <div class="toctree-smilei">
                    <ul>
                        <li class="outer">
                            <a href="basics_setup.html">Setup</a>
                        </li>
                        <li class="outer">
                            <a href="basics_laser_vacuum.html">Laser Propagation in vacuum</a>
                        </li>
                        <li class="outer">
                            <a href="basics_thermal_plasma.html">Thermal plasma</a>
                        </li>
                        <li class="outer">
                            <a href="basics_weibel_twostream.html">Weibel and two-stream instabilities</a>
                        </li>
                        <li class="outer">
                            <a href="basics_units.html">Units</a>
                        </li>
        
                    </ul>
                </div>
            </div>
        </div>
        <div class="menu"
            id="menu_Performances"
            
        >
            <div id="menuButton_Performances" class="menuButton"
                 onmouseenter="prepareMenu('menu_Performances')"
                 onmousedown="event.preventDefault()"
            >
                <a href="perfs.html">
                    <span>Performances</span>
                </a>
            </div>
            <div class="off" onmouseleave="leaveMenu('menu_Performances',this)">
                <div class="toctree-smilei">
                    <ul>
                        <li class="outer">
                            <a href="perfs_parallel_computing.html">Parallel computing</a>
                        </li>
                        <li class="outer">
                            <a href="perfs_patch_arrangement.html">Patch arrangement</a>
                        </li>
        
                    </ul>
                </div>
            </div>
        </div>
        <div class="last menu"
            id="menu_Advanced"
            style="font-weight:bold"
        >
            <div id="menuButton_Advanced" class="menuButton"
                 onmouseenter="prepareMenu('menu_Advanced')"
                 onmousedown="event.preventDefault()"
            >
                <a href="advanced.html">
                    <span>Advanced</span>
                </a>
            </div>
            <div class="off" onmouseleave="leaveMenu('menu_Advanced',this)">
                <div class="toctree-smilei">
                    <ul>
                        <li class="outer">
                            <a href="advanced_field_ionization.html">Field ionization</a>
                        </li>
                        <li >
                            <a href="#">Binary collisions and impact ionization</a>
                        </li>
                        <li class="outer">
                            <a href="advanced_radiation_reaction.html">Synchrotron-like radiation reaction</a>
                        </li>
                        <li class="outer">
                            <a href="advanced_breit_wheeler.html">Multiphoton Breit-Wheeler pair creation process</a>
                        </li>
                        <li class="outer">
                            <a href="advanced_wakefield.html">2D laser wakefield acceleration</a>
                        </li>
                        <li class="outer">
                            <a href="advanced_wakefield_AMcylindrical.html">Azimuthal-mode-decomposition cylindrical geometry</a>
                        </li>
                        <li class="outer">
                            <a href="advanced_wakefield_electron_beam.html">Field initialization for a relativistic electron bunch</a>
                        </li>
                        <li class="outer">
                            <a href="advanced_wakefield_envelope.html">Envelope model for laser wakefield acceleration</a>
                        </li>
                        <li class="outer">
                            <a href="advanced_vtk.html">Export to VTK and 3D visualization</a>
                        </li>
        
                    </ul>
                </div>
            </div>
        </div>
        
        <script type="text/javascript">
            var es=document.getElementsByClassName("menuButton"), i=0;
            var evt = "ontouchend" in document ? "touchend" : "click";
            for( var i=0; i<es.length; i+=1 ) {
                es[i].addEventListener(evt, function(a){ return function(){toggleMenu(a)};}(es[i].parentNode.id));
            }
        </script>
        
        <div id="searchbox" role="search" style="display:none">
            <form class="search" action="search.html" method="get">
              <input type="text" name="q" placeholder="Search" id="searchinput" />
              <input type="hidden" name="check_keywords" value="yes" />
              <input type="hidden" name="area" value="default" />
            </form>
        </div>
        
        <div id="searchicon" onclick="openSearch()" style="display:block">
            <svg
               xmlns="http://www.w3.org/2000/svg"
               viewBox="0 0 80 120">
              <g transform="translate(0,-932.36216)" >
                <circle
                   r="25" cy="977.51044" cx="38.078663"
                   style="opacity:1;fill:none;stroke:#ffffff;stroke:var(--header_text);stroke-width:10;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1" />
                <rect
                   transform="matrix(0.36717877,0.93015039,-0.93427297,0.35655858,0,0)"
                   rx="4.9996676" ry="7.4995141" x="947.6142" y="316.16959"
                   height="14.117695" width="46.476151"
                   style="opacity:1;fill:#ffffff;fill:var(--header_text);fill-opacity:1;stroke:none;" />
                <path
                   d="m 41.383282,962.25996 a 15,15 0 0 1 11.660107,11.6355"
                   style="opacity:1;fill:none;stroke:#ffffff;stroke:var(--header_text);stroke-width:3;stroke-linecap:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1" />
              </g>
            </svg>
        </div>
        <div id="closesearchicon" onclick="closeSearch()" style="display:none">
            <svg
               xmlns="http://www.w3.org/2000/svg"
               viewBox="0 0 80 120">
              <g
                 transform="translate(0,-932.36216)"
                 style="fill:none;stroke:#ffffff;stroke:var(--header_text);stroke-width:10;stroke-linecap:round;stroke-linejoin:miter;stroke-opacity:1;stroke-miterlimit:4;stroke-dasharray:none">
                <path d="m 10,962.36216 60,60.00004" />
                <path d="M 70,962.36216 10,1022.3622" />
              </g>
            </svg>
        </div>
        
        <div id="smallScreenMenuButton" onclick="event.preventDefault(); toggleSmallScreenMenu(event)">
            <svg xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg"
               viewBox="-20 -20 140 140">
              <g  style="fill:#ffffff; fill:var(--header_text);stroke:none;">
                <circle cx="15" cy="20" r="5" />
                <circle cx="35" cy="20" r="5" />
                <circle cx="85" cy="20" r="5" />
                <rect width="50" height="10" x="35" y="15" rx="0" ry="0" />
                <circle cx="15" cy="40" r="5" />
                <circle cx="35" cy="40" r="5" />
                <circle cx="85" cy="40" r="5" />
                <rect width="50" height="10" x="35" y="35" rx="0" ry="0" />
                <circle cx="15" cy="60" r="5" />
                <circle cx="35" cy="60" r="5" />
                <circle cx="85" cy="60" r="5" />
                <rect width="50" height="10" x="35" y="55" rx="0" ry="0" />
                <circle cx="15" cy="80" r="5" />
                <circle cx="35" cy="80" r="5" />
                <circle cx="85" cy="80" r="5" />
                <rect width="50" height="10" x="35" y="75" rx="0" ry="0" />
              </g>
            </svg>
        </div>
        
    </div>
    
</div>
</div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="binary-collisions-and-impact-ionization">
<h1>Binary collisions and impact ionization<a class="headerlink" href="#binary-collisions-and-impact-ionization" title="Permalink to this headline">¶</a></h1>
<p>Smilei includes binary collisions between various species, which can also generate
ionization when one of the species is ions and the other one electrons.
<a class="reference external" href="https://smileipic.github.io/Smilei/Understand/collisions.html">Smilei’s website</a>
already gives a description of the approach, and provides results from various benchmarks.</p>
<p>The list of benchmarks, located in the <code class="docutils literal notranslate"><span class="pre">benchmarks/collisions/</span></code> folder is briefly
described below. You may run any of these benchmarks depending on your interests.</p>
<div class="section" id="beam-relaxation">
<h2>Beam relaxation<a class="headerlink" href="#beam-relaxation" title="Permalink to this headline">¶</a></h2>
<p>An electron beam encounters a thermal ion population; <em>e-i</em> collisions slow the beam down
and make it spread. Various electron velocities and ion charges are considered. For each
case, the ratios of weights between electrons and ions is varied.</p>
<p class="rubric">1.  initial velocity = 0.05, ion charge = 1</p>
<div class="line-block">
<div class="line"><code class="docutils literal notranslate"><span class="pre">beam_relaxation1.py</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">beam_relaxation2.py</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">beam_relaxation3.py</span></code></div>
<div class="line">Analysis and plotting provided in <code class="docutils literal notranslate"><span class="pre">beam_relaxation123.py</span></code></div>
</div>
<p class="rubric">2.  initial velocity = 0.01, ion charge = 1</p>
<div class="line-block">
<div class="line"><code class="docutils literal notranslate"><span class="pre">beam_relaxation4.py</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">beam_relaxation5.py</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">beam_relaxation6.py</span></code></div>
<div class="line">Analysis and plotting provided in <code class="docutils literal notranslate"><span class="pre">beam_relaxation456.py</span></code></div>
</div>
<p class="rubric">3.  initial velocity = 0.01, ion charge = 3</p>
<div class="line-block">
<div class="line"><code class="docutils literal notranslate"><span class="pre">beam_relaxation7.py</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">beam_relaxation8.py</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">beam_relaxation9.py</span></code></div>
<div class="line">Analysis and plotting provided in <code class="docutils literal notranslate"><span class="pre">beam_relaxation789.py</span></code></div>
</div>
</div>
<div class="section" id="thermalization">
<h2>Thermalization<a class="headerlink" href="#thermalization" title="Permalink to this headline">¶</a></h2>
<p>Thermal electrons start with a different temperature from that of ions.
The thermalization due to <em>e-i</em> collisions is monitored for three different weight ratios.</p>
<div class="line-block">
<div class="line"><code class="docutils literal notranslate"><span class="pre">thermalisation_ei1.py</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">thermalisation_ei2.py</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">thermalisation_ei3.py</span></code></div>
<div class="line">Analysis and plotting provided in <code class="docutils literal notranslate"><span class="pre">thermalisation_ei123.py</span></code></div>
</div>
</div>
<div class="section" id="temperature-isotropization">
<h2>Temperature isotropization<a class="headerlink" href="#temperature-isotropization" title="Permalink to this headline">¶</a></h2>
<p>Non-isotropic thermal electrons are isotropized with <em>e-e</em> collisions.</p>
<div class="line-block">
<div class="line"><code class="docutils literal notranslate"><span class="pre">temperature_isotropization1.py</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">temperature_isotropization2.py</span></code></div>
<div class="line">Analysis and plotting provided in <code class="docutils literal notranslate"><span class="pre">temperature_isotropization.py</span></code></div>
</div>
</div>
<div class="section" id="maxwellianization">
<h2>Maxwellianization<a class="headerlink" href="#maxwellianization" title="Permalink to this headline">¶</a></h2>
<p>An electron population starting with a rectangular velocity distribution becomes
maxwellian due to <em>e-e</em> collisions.</p>
<div class="line-block">
<div class="line"><code class="docutils literal notranslate"><span class="pre">Maxwellianization1.py</span></code></div>
<div class="line">Analysis and plotting provided in <code class="docutils literal notranslate"><span class="pre">Maxwellianization.py</span></code></div>
</div>
</div>
<div class="section" id="stopping-power">
<h2>Stopping power<a class="headerlink" href="#stopping-power" title="Permalink to this headline">¶</a></h2>
<p>The <em>e-e</em> slowing rate of test electrons passing through an electron plasma is monitored
<em>vs.</em> time and compared to a theoretical stopping power.</p>
<div class="line-block">
<div class="line"><code class="docutils literal notranslate"><span class="pre">Stopping_power1.py</span></code> : projectiles from 10 to 30 keV</div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">Stopping_power2.py</span></code> : projectiles from 100 to 300 keV</div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">Stopping_power3.py</span></code> : projectiles from 1 to 10 MeV</div>
<div class="line">Analysis and plotting provided in <code class="docutils literal notranslate"><span class="pre">Stopping_power123.py</span></code></div>
</div>
</div>
<div class="section" id="ionization-rate">
<h2>Ionization rate<a class="headerlink" href="#ionization-rate" title="Permalink to this headline">¶</a></h2>
<p>Drifting electrons in a cold Al plasma cause <em>e-i</em> impact ionization at a rate compared
to theoretical values. The three inputs below correspond to various weight ratios
between electrons and ions.</p>
<div class="line-block">
<div class="line"><code class="docutils literal notranslate"><span class="pre">ionization_rate1.py</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">ionization_rate2.py</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">ionization_rate3.py</span></code></div>
<div class="line">Analysis and plotting provided in <code class="docutils literal notranslate"><span class="pre">ionization_rate.py</span></code></div>
</div>
</div>
<div class="section" id="inelastic-stopping-power">
<h2>Inelastic stopping power<a class="headerlink" href="#inelastic-stopping-power" title="Permalink to this headline">¶</a></h2>
<p>The ionizing <em>e-i</em> slowing rate of test electrons passing through an Al plasma
is monitored <em>vs.</em> time and compared to a theoretical stopping power.</p>
<div class="line-block">
<div class="line"><code class="docutils literal notranslate"><span class="pre">ionization_stopping_power1.py</span></code> : measurement for electrons at various energies</div>
</div>
<div class="line-block">
<div class="line"><code class="docutils literal notranslate"><span class="pre">ionization_stopping_power2.py</span></code> :</div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">ionization_stopping_power3.py</span></code> : three examples to show the stopping dynamics</div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">ionization_stopping_power4.py</span></code> :</div>
</div>
<div class="line-block">
<div class="line">Analysis and plotting provided in <code class="docutils literal notranslate"><span class="pre">ionization_stopping_power.py</span></code></div>
</div>
</div>
<div class="section" id="multiple-ionization">
<h2>Multiple ionization<a class="headerlink" href="#multiple-ionization" title="Permalink to this headline">¶</a></h2>
<p>The capability to ionize several times in one timestep is illustrated for five different
materials. For each material, two cases are provided: the first is well resolved, while
the second has a low time resolution requiring multiple ionization.</p>
<div class="line-block">
<div class="line"><code class="docutils literal notranslate"><span class="pre">ionization_multipleC1.py</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">ionization_multipleC2.py</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">ionization_multipleAl1.py</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">ionization_multipleAl2.py</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">ionization_multipleZn1.py</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">ionization_multipleZn2.py</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">ionization_multipleSn1.py</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">ionization_multipleSn2.py</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">ionization_multipleAu1.py</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">ionization_multipleAu2.py</span></code></div>
<div class="line">Analysis and plotting provided in <code class="docutils literal notranslate"><span class="pre">ionization_multiple.py</span></code></div>
</div>
</div>
<div class="section" id="effect-of-neglecting-recombination">
<h2>Effect of neglecting recombination<a class="headerlink" href="#effect-of-neglecting-recombination" title="Permalink to this headline">¶</a></h2>
<p>As recombination is not accounted for, we can expect excess ionization to occur
indefinitely without being balanced to equilibrium. For picosecond laser interaction,
we illustrate here that the recombination rate can be neglected, thus providing
reasonable ionization state <em>vs.</em> temperature, in various materials.</p>
<div class="line-block">
<div class="line"><code class="docutils literal notranslate"><span class="pre">ionization_equilibriumH.py</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">ionization_equilibriumAl.py</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">ionization_equilibriumZn.py</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">ionization_equilibriumAu.py</span></code></div>
<div class="line">Analysis and plotting provided in <code class="docutils literal notranslate"><span class="pre">ionization_equilibrium.py</span></code></div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      <div>
        <input type="button" id="themebutton"  value="" onclick="switchTheme('')" />
      </div>
      <div>
      <a href="site.html">Site index</a>
      </div>
      <div>
        Last updated on Mar 12, 2025
      </div>
      
      <div>
      Powered by <a href="http://sphinx-doc.org/">Sphinx 2.4.4</a>
      </div>
      
    </div>
    
    <script type="text/javascript">
        
        var nav = document.getElementById("nav");
        var nav_list = document.getElementById("nav_list");
        var nav_button = document.getElementById("nav_button");
        var smallScreenMenu = document.getElementById("smallScreenMenu");
        var smallScreenMenuButton = document.getElementById("smallScreenMenuButton");
        var searchicon = document.getElementById("searchicon");
        var searchbox  = document.getElementById("searchbox");
        var searchinput= document.getElementById("searchinput");
        var menus = document.getElementsByClassName("menu");
        for( var i=0; i<menus.length; i++ )
            menus[i].active = false;
        
        // Manage theme
        var theme="light";
        function switchTheme(type) {
            if( type == "dark" || ( ! type && theme == "light" ) ) {
                theme = "dark";
                document.documentElement.setAttribute('theme', 'dark');
                window.name = "dark_theme"
                localStorage.setItem("_theme","dark")
            } else {
                theme = "light";
                document.documentElement.setAttribute('theme', 'light');
                window.name = "light_theme"
                localStorage.setItem("_theme","light")
            }
        }
        if( window.name && window.name == "light_theme" ) {
            switchTheme("light");
        } else if ( window.name && window.name == "dark_theme" ) {
            switchTheme("dark");
        } else if( stored_theme = localStorage.getItem("_theme") ) {
            switchTheme(stored_theme);
        } else if( window.matchMedia && window.matchMedia("(prefers-color-scheme: dark)").matches) {
            switchTheme("dark");
        }
        
        var ul = nav_list.getElementsByTagName("ul")[0], li;
        var keep_nav = false;
        if( ul ) {
            li = ul.firstElementChild;
            if( li ) {
                if( li.getElementsByTagName("ul").length > 0 ) keep_nav = true;
            }
        }
        if( keep_nav ) {
            li.removeChild( li.firstElementChild );
        } else {
            document.getElementById("nav_positioner").removeChild( document.getElementById("nav") );
        }
        
        function navOff() {
            nav_list.style.display = "none";
            nav_button.className = "";
            nav.style.overflowY = "visible";
        }
        
        function toggleNav() {
            for( var i=0; i<menus.length; i++ )
                menuOff( menus[i] );
            if( nav_list.style.display != "inline-block" ) {
                nav_list.style.display = "inline-block";
                nav_button.className = "pushed";
                nav.style.overflowY = "auto";
            } else {
                navOff();
            }
        }
        
        function toggleSmallScreenMenu(e) {
            if( smallScreenMenu.className != "on" ) {
                smallScreenMenu.className = "on";
                smallScreenMenuButton.className = "pushed";
                document.documentElement.style.overflow = "hidden";
            } else {
                smallScreenMenu.className = "off";
                smallScreenMenuButton.className = "";
                document.documentElement.style.overflow = "";
            }
        }
        
        if (smallScreenMenuAfterTOC = document.getElementById("smallScreenMenuAfterTOC")) {
            var smallScreenMenuTOC = smallScreenMenuAfterTOC.previousElementSibling
                .getElementsByTagName("li")[0].getElementsByTagName("ul")[0].getElementsByTagName("li");
            for (var i = 0; i < smallScreenMenuTOC.length; i++) {
                if (smallScreenMenuTOC[i].tagName = "a") {
                    smallScreenMenuTOC[i].addEventListener("click", function(event){ toggleSmallScreenMenu(event); } );
                }
            }
        }
        
        function prepareMenu(menu_id) {
            var menu = document.getElementById(menu_id);
            menu.timer1 = setTimeout(function(a){ return function(){thisMenuOnly(a)};}(menu_id), 100);
            menu.addEventListener("mouseleave", function(a){ return function(){clearTimeout(a.timer1)};}(menu) );
        }
        
        function leaveMenu(menu_id, source) {
            var menu = document.getElementById(menu_id);
            menu.timer2 = setTimeout(function(a){ return function(){menuOff(a)};}(menu), 1000);
            source.addEventListener("mouseenter", function(a){ return function(){clearTimeout(a.timer2)};}(menu) );
        }
        
        function menuOn( menu ) {
            var divs = menu.getElementsByTagName("div");
            if(nav_list) navOff();
            divs[1].className = "on";
            divs[0].className = "menuButton pushed";
            menu.active = true;
        }
        function menuOff( menu ) {
            var divs = menu.getElementsByTagName("div");
            divs[1].className = "off";
            divs[0].className = "menuButton";
            menu.active = false;
        }
        
        function thisMenuOnly(menu_id) {
            var menu = document.getElementById(menu_id);
            for( var i=0; i<menus.length; i++ )
                if( i!=menu_id )
                    menuOff( menus[i] );
            menuOn( menu );
        }
        
        function toggleMenu(menu_id) {
            var menu = document.getElementById(menu_id);
            if( menu.active ) {
                menuOff( menu );
            } else {
                for( var i=0; i<menus.length; i++ )
                    if( i!=menu_id )
                        menuOff( menus[i] );
                menuOn( menu );
            }
        }
        
        function openSearch() {
            for( var i=0; i<menus.length; i++ ) {
                menuOff( menus[i] );
                menus[i].style.zIndex = "-1";
            }
            searchicon.style.display = "none";
            closesearchicon.style.display = "block";
            searchbox.style.display = "block";
            searchinput.focus();
        }
        
        function closeSearch() {
            searchicon.style.display = "block";
            closesearchicon.style.display = "none";
            searchbox .style.display = "none";
            for( var i=0; i<menus.length; i++ )
                menus[i].style.zIndex = "0";
        }
        
        
        var documentDiv = document.getElementsByClassName("document")[0];
        documentDiv.addEventListener('click', function (event) {
            if(nav_list) navOff();
            for( var i=0; i<menus.length; i++ )
                menuOff( menus[i] );
        });
    </script>
  </body>
</html>